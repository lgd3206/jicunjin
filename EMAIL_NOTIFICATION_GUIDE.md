"""
é‚®ä»¶é€šçŸ¥ç³»ç»Ÿ - ä½¿ç”¨æŒ‡å—
"""

# ============================================================================
# ğŸ“§ é‚®ä»¶é€šçŸ¥ç³»ç»Ÿ - å®Œæ•´ä½¿ç”¨æŒ‡å—
# ============================================================================

## ğŸ“‹ ç›®å½•

1. [ç³»ç»Ÿæ¦‚è¿°](#ç³»ç»Ÿæ¦‚è¿°)
2. [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
3. [é…ç½®è¯´æ˜](#é…ç½®è¯´æ˜)
4. [åŠŸèƒ½è¯¦è§£](#åŠŸèƒ½è¯¦è§£)
5. [é›†æˆç¤ºä¾‹](#é›†æˆç¤ºä¾‹)
6. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)
7. [æ•…éšœæ’æŸ¥](#æ•…éšœæ’æŸ¥)

---

## ç³»ç»Ÿæ¦‚è¿°

### åŠŸèƒ½ç‰¹æ€§

âœ… **å¤šé‚®ç®±æ”¯æŒ**
- QQé‚®ç®± (smtp.qq.com:587)
- 163é‚®ç®± (smtp.163.com:587)
- æ˜“äºæ‰©å±•æ”¯æŒå…¶ä»–é‚®ç®±

âœ… **ä¸“ä¸šé‚®ä»¶æ¨¡æ¿**
- HTMLæ ¼å¼ï¼Œç¾è§‚ä¸“ä¸š
- åŒ…å«æ‰€æœ‰å…³é”®ä¿¡æ¯ï¼šå“ç§ã€ä»·æ ¼ã€æå€¼ã€å·®å€¼ã€æ—¶é—´
- å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒå„ç§é‚®ä»¶å®¢æˆ·ç«¯

âœ… **çµæ´»é…ç½®**
- ä½¿ç”¨ .env æ–‡ä»¶ç®¡ç†é…ç½®
- æ”¯æŒå¤šæ”¶ä»¶äºº
- å¯é…ç½®çš„æé†’é˜ˆå€¼
- æµ‹è¯•æ¨¡å¼æ”¯æŒ

âœ… **å®Œæ•´é›†æˆ**
- ä¸æå€¼æé†’ç³»ç»Ÿæ— ç¼é›†æˆ
- æ”¯æŒæ‰¹é‡å‘é€
- è¯¦ç»†çš„æ—¥å¿—è®°å½•

### ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   æå€¼ä»·æ ¼æé†’ç³»ç»Ÿ                        â”‚
â”‚              (ExtremePriceAlert)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   é‚®ä»¶æé†’é›†æˆ                            â”‚
â”‚            (EmailAlertIntegration)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â–¼            â–¼            â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ é…ç½®   â”‚  â”‚ é‚®ä»¶   â”‚  â”‚ æ—¥å¿—   â”‚
    â”‚ åŠ è½½å™¨ â”‚  â”‚ é€šçŸ¥å™¨ â”‚  â”‚ ç³»ç»Ÿ   â”‚
    â”‚ Config â”‚  â”‚ Email  â”‚  â”‚ Logger â”‚
    â”‚Loader  â”‚  â”‚Notifierâ”‚  â”‚        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚            â”‚            â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚   SMTPæœåŠ¡å™¨    â”‚
            â”‚  (QQ/163é‚®ç®±)   â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚   æ”¶ä»¶äººé‚®ç®±    â”‚
            â”‚  (å¤šä¸ªæ”¶ä»¶äºº)   â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å¿«é€Ÿå¼€å§‹

### 1. å‡†å¤‡å·¥ä½œ

#### è·å–QQé‚®ç®±æˆæƒç 

1. ç™»å½• QQé‚®ç®± (https://mail.qq.com)
2. ç‚¹å‡»"è®¾ç½®" â†’ "è´¦æˆ·"
3. æ‰¾åˆ°"POP3/IMAP/SMTP/Exchange/CardDAV/CalDAVæœåŠ¡"
4. ç‚¹å‡»"ç”Ÿæˆæˆæƒç "
5. æŒ‰ç…§æç¤ºå®ŒæˆéªŒè¯ï¼Œå¤åˆ¶æˆæƒç 

#### è·å–163é‚®ç®±æˆæƒç 

1. ç™»å½• 163é‚®ç®± (https://mail.163.com)
2. ç‚¹å‡»"è®¾ç½®" â†’ "POP3/SMTP/IMAP"
3. ç‚¹å‡»"å¼€å¯"
4. æŒ‰ç…§æç¤ºå®ŒæˆéªŒè¯ï¼Œè·å–æˆæƒç 

### 2. é…ç½®æ–‡ä»¶

å¤åˆ¶ `.env.example` ä¸º `.env`ï¼š

```bash
cp .env.example .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œå¡«å…¥ä½ çš„é‚®ç®±ä¿¡æ¯ï¼š

```env
# é‚®ç®±é…ç½®
EMAIL_TYPE=qq
EMAIL_ADDRESS=your_email@qq.com
APP_PASSWORD=your_app_password_here

# æ”¶ä»¶äººé…ç½®
RECIPIENT_EMAILS=recipient1@qq.com,recipient2@163.com

# æé†’é…ç½®
DROP_THRESHOLD_PERCENT=5.0
ENABLE_EMAIL_NOTIFICATION=true
TEST_MODE=false

# æ•°æ®åº“é…ç½®
DATABASE_PATH=gold_prices.db

# æ—¥å¿—é…ç½®
LOG_LEVEL=INFO
LOG_FILE=logs/notifications.log
```

### 3. æµ‹è¯•è¿æ¥

è¿è¡Œæµ‹è¯•è„šæœ¬éªŒè¯é…ç½®ï¼š

```bash
python test_email_notification.py
```

é¢„æœŸè¾“å‡ºï¼š

```
============================================================
é‚®ä»¶é€šçŸ¥ç³»ç»Ÿ - å®Œæ•´æµ‹è¯•å¥—ä»¶
============================================================

============================================================
æµ‹è¯• 1: é…ç½®åŠ è½½å™¨
============================================================
âœ“ é…ç½®åŠ è½½æˆåŠŸ

é‚®ä»¶é…ç½®:
  - é‚®ç®±ç±»å‹: QQ
  - é‚®ç®±åœ°å€: your_email@qq.com

...

ğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼
```

### 4. å‘é€æµ‹è¯•é‚®ä»¶

è¿è¡Œé›†æˆè„šæœ¬å‘é€æµ‹è¯•é‚®ä»¶ï¼š

```bash
python email_alert_integration.py
```

---

## é…ç½®è¯´æ˜

### .env æ–‡ä»¶è¯¦è§£

#### é‚®ç®±é…ç½®

```env
# é‚®ç®±ç±»å‹: 'qq' æˆ– '163'
EMAIL_TYPE=qq

# é‚®ç®±åœ°å€
EMAIL_ADDRESS=your_email@qq.com

# åº”ç”¨æˆæƒç ï¼ˆä¸æ˜¯é‚®ç®±å¯†ç ï¼ï¼‰
APP_PASSWORD=your_app_password_here
```

**é‡è¦æç¤º**ï¼š
- `APP_PASSWORD` æ˜¯åº”ç”¨æˆæƒç ï¼Œä¸æ˜¯é‚®ç®±å¯†ç 
- è·å–æ–¹å¼è§ä¸Šé¢çš„"å¿«é€Ÿå¼€å§‹"éƒ¨åˆ†
- ä¸è¦åœ¨ä»£ç ä¸­ç¡¬ç¼–ç å¯†ç 

#### æ”¶ä»¶äººé…ç½®

```env
# ä¸»è¦æ”¶ä»¶äººé‚®ç®±ï¼ˆå¤šä¸ªé‚®ç®±ç”¨é€—å·åˆ†éš”ï¼‰
RECIPIENT_EMAILS=recipient1@qq.com,recipient2@163.com
```

**æ”¯æŒå¤šä¸ªæ”¶ä»¶äºº**ï¼š
- ç”¨é€—å·åˆ†éš”å¤šä¸ªé‚®ç®±
- æ¯ä¸ªé‚®ç®±ä¼šæ”¶åˆ°ç›¸åŒçš„æé†’é‚®ä»¶
- æ”¯æŒä»»ä½•é‚®ç®±ç±»å‹ï¼ˆQQã€163ã€Gmailç­‰ï¼‰

#### æé†’é…ç½®

```env
# ä»·æ ¼ä¸‹è·Œé˜ˆå€¼ï¼ˆç™¾åˆ†æ¯”ï¼Œé»˜è®¤5%ï¼‰
DROP_THRESHOLD_PERCENT=5.0

# æ˜¯å¦å¯ç”¨é‚®ä»¶é€šçŸ¥
ENABLE_EMAIL_NOTIFICATION=true

# æ˜¯å¦å¯ç”¨æµ‹è¯•æ¨¡å¼ï¼ˆæµ‹è¯•æ¨¡å¼ä¸‹ä¸ä¼šçœŸæ­£å‘é€é‚®ä»¶ï¼‰
TEST_MODE=false
```

**æµ‹è¯•æ¨¡å¼è¯´æ˜**ï¼š
- è®¾ç½® `TEST_MODE=true` æ—¶ï¼Œç³»ç»Ÿä¼šæ¨¡æ‹Ÿå‘é€é‚®ä»¶ä½†ä¸çœŸæ­£å‘é€
- ç”¨äºæµ‹è¯•é…ç½®å’Œæµç¨‹ï¼Œä¸ä¼šæ¶ˆè€—é‚®ä»¶é…é¢
- ç”Ÿäº§ç¯å¢ƒåº”è®¾ç½®ä¸º `false`

#### æ•°æ®åº“é…ç½®

```env
# SQLite æ•°æ®åº“è·¯å¾„
DATABASE_PATH=gold_prices.db
```

#### æ—¥å¿—é…ç½®

```env
# æ—¥å¿—çº§åˆ«: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# æ—¥å¿—æ–‡ä»¶è·¯å¾„
LOG_FILE=logs/notifications.log
```

---

## åŠŸèƒ½è¯¦è§£

### 1. é…ç½®åŠ è½½å™¨ (ConfigLoader)

**ä½ç½®**: `config/config_loader.py`

**ä¸»è¦æ–¹æ³•**:

```python
# åˆå§‹åŒ–
config_loader = ConfigLoader('.env')

# è·å–é‚®ä»¶é…ç½®
email_config = config_loader.get_email_config()
# è¿”å›: {'email_type': 'qq', 'email_address': '...', 'app_password': '...'}

# è·å–æ”¶ä»¶äººåˆ—è¡¨
recipients = config_loader.get_recipient_emails()
# è¿”å›: ['recipient1@qq.com', 'recipient2@163.com']

# è·å–æé†’é…ç½®
alert_config = config_loader.get_alert_config()
# è¿”å›: {'drop_threshold_percent': 5.0, 'enable_email_notification': True, ...}

# éªŒè¯é…ç½®
config_loader.validate_email_config()  # éªŒè¯é‚®ä»¶é…ç½®
config_loader.validate_recipient_emails()  # éªŒè¯æ”¶ä»¶äººé…ç½®
```

### 2. é‚®ä»¶é€šçŸ¥å™¨ (EmailNotifier)

**ä½ç½®**: `notifications/email_notifier.py`

**ä¸»è¦æ–¹æ³•**:

```python
# åˆå§‹åŒ–
notifier = EmailNotifier(
    email_address='your_email@qq.com',
    app_password='your_app_password',
    email_type='qq'
)

# å‘é€å•ä¸ªé‚®ä»¶
success = notifier.send_alert_email(
    recipient_email='recipient@qq.com',
    alert_result={...}
)

# æ‰¹é‡å‘é€é‚®ä»¶
results = notifier.send_batch_emails(
    recipient_emails=['recipient1@qq.com', 'recipient2@163.com'],
    alert_result={...}
)
# è¿”å›: {'recipient1@qq.com': True, 'recipient2@163.com': True}

# æµ‹è¯•è¿æ¥
success = notifier.test_connection()

# è·å–æ”¯æŒçš„é‚®ç®±ç±»å‹
types = EmailNotifier.get_supported_email_types()
# è¿”å›: {'qq': 'QQé‚®ç®±', '163': '163é‚®ç®±'}
```

### 3. é‚®ä»¶æé†’é›†æˆ (EmailAlertIntegration)

**ä½ç½®**: `email_alert_integration.py`

**ä¸»è¦æ–¹æ³•**:

```python
# åˆå§‹åŒ–
integration = EmailAlertIntegration('.env')

# æµ‹è¯•é‚®ä»¶è¿æ¥
success = integration.test_email_connection()

# å‘é€æé†’é‚®ä»¶
results = integration.send_alert_emails(alert_result)

# ä¸ºç‰¹å®šå“ç§å‘é€æé†’
results = integration.send_alert_for_product(
    product_name='AU9999',
    current_price=380.20,
    alert_result={...}
)

# æ‰¹é‡å‘é€æé†’
all_results = integration.send_batch_alerts(alert_results)

# è·å–é…ç½®æ‘˜è¦
summary = integration.get_config_summary()
```

---

## é›†æˆç¤ºä¾‹

### ç¤ºä¾‹ 1: åŸºç¡€ä½¿ç”¨

```python
from config.config_loader import ConfigLoader
from notifications.email_notifier import EmailNotifier

# åŠ è½½é…ç½®
config_loader = ConfigLoader('.env')
email_config = config_loader.get_email_config()
recipients = config_loader.get_recipient_emails()

# åˆå§‹åŒ–é‚®ä»¶é€šçŸ¥å™¨
notifier = EmailNotifier(
    email_address=email_config['email_address'],
    app_password=email_config['app_password'],
    email_type=email_config['email_type']
)

# æµ‹è¯•è¿æ¥
if notifier.test_connection():
    print("é‚®ä»¶è¿æ¥æˆåŠŸï¼")
else:
    print("é‚®ä»¶è¿æ¥å¤±è´¥ï¼")
```

### ç¤ºä¾‹ 2: ä¸æå€¼æé†’é›†æˆ

```python
from database.db_manager import DatabaseManager
from alerts.extreme_price_alert import ExtremePriceAlert
from email_alert_integration import EmailAlertIntegration

# åˆå§‹åŒ–ç³»ç»Ÿ
db = DatabaseManager('gold_prices.db')
alert_system = ExtremePriceAlert(db, drop_threshold_percent=5.0)
email_integration = EmailAlertIntegration('.env')

# æ£€æŸ¥æå€¼æé†’
result = alert_system.check_trigger_condition('AU9999', 380.20)

# å¦‚æœéœ€è¦æé†’ï¼Œå‘é€é‚®ä»¶
if result['should_alert']:
    email_integration.send_alert_emails(result)
    print(f"å·²å‘é€ {result['product_name']} çš„æé†’é‚®ä»¶")
```

### ç¤ºä¾‹ 3: æ‰¹é‡å¤„ç†

```python
from email_alert_integration import EmailAlertIntegration

# åˆå§‹åŒ–é›†æˆ
integration = EmailAlertIntegration('.env')

# æ¨¡æ‹Ÿå¤šä¸ªæé†’ç»“æœ
alert_results = [
    {
        'product_name': 'AU9999',
        'current_price': 380.20,
        'should_alert': True,
        'alert_level': 'high',
        'alert_reasons': ['å½“å‰ä»·æ ¼æ˜¯24å°æ—¶æœ€ä½ä»·'],
        'extremes': {...},
        'price_diff': {...},
        'timestamp': '2024-01-15T10:30:00'
    },
    # ... æ›´å¤šæé†’ç»“æœ
]

# æ‰¹é‡å‘é€
all_results = integration.send_batch_alerts(alert_results)

# æ˜¾ç¤ºç»“æœ
for product_name, email_results in all_results.items():
    success_count = sum(1 for v in email_results.values() if v)
    print(f"{product_name}: {success_count}/{len(email_results)} ä¸ªæ”¶ä»¶äºº")
```

### ç¤ºä¾‹ 4: å®Œæ•´å·¥ä½œæµ

```python
from database.db_manager import DatabaseManager
from alerts.extreme_price_alert import ExtremePriceAlert
from email_alert_integration import EmailAlertIntegration

# åˆå§‹åŒ–
db = DatabaseManager('gold_prices.db')
alert_system = ExtremePriceAlert(db)
email_integration = EmailAlertIntegration('.env')

# å®šä¹‰è¦ç›‘æ§çš„å“ç§å’Œä»·æ ¼
products = ['AU9999', 'AU100G', 'AU50G']
current_prices = [380.20, 3800.00, 1900.00]

# æ‰¹é‡æ£€æŸ¥æå€¼æé†’
alert_results = alert_system.batch_check_alerts(products, current_prices)

# æ‰¹é‡å‘é€é‚®ä»¶
all_results = email_integration.send_batch_alerts(alert_results)

# æ˜¾ç¤ºæ‘˜è¦
summary = alert_system.get_alert_summary(alert_results)
print(f"æ€»å…±è§¦å‘ {summary['total_triggered']} ä¸ªæé†’")
print(f"  - é«˜çº§æé†’: {summary['high_level']}")
print(f"  - ä¸­çº§æé†’: {summary['medium_level']}")
```

---

## å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•è·å–åº”ç”¨æˆæƒç ï¼Ÿ

**A**: è§"å¿«é€Ÿå¼€å§‹"éƒ¨åˆ†çš„è¯¦ç»†æ­¥éª¤ã€‚æ³¨æ„ï¼š
- æˆæƒç ä¸æ˜¯é‚®ç®±å¯†ç 
- æˆæƒç é€šå¸¸æ˜¯16ä½å­—ç¬¦
- ä¸è¦åœ¨ä»£ç ä¸­ç¡¬ç¼–ç ï¼Œä½¿ç”¨ .env æ–‡ä»¶

### Q2: æ”¯æŒå“ªäº›é‚®ç®±ç±»å‹ï¼Ÿ

**A**: ç›®å‰æ”¯æŒï¼š
- QQé‚®ç®± (smtp.qq.com:587)
- 163é‚®ç®± (smtp.163.com:587)

å¯ä»¥é€šè¿‡ä¿®æ”¹ `EmailNotifier.SMTP_CONFIG` æ·»åŠ å…¶ä»–é‚®ç®±ç±»å‹ã€‚

### Q3: å¦‚ä½•æ·»åŠ æ–°çš„é‚®ç®±ç±»å‹ï¼Ÿ

**A**: ç¼–è¾‘ `notifications/email_notifier.py`ï¼š

```python
SMTP_CONFIG = {
    'qq': {
        'smtp_server': 'smtp.qq.com',
        'smtp_port': 587,
        'description': 'QQé‚®ç®±'
    },
    '163': {
        'smtp_server': 'smtp.163.com',
        'smtp_port': 587,
        'description': '163é‚®ç®±'
    },
    'gmail': {  # æ–°å¢
        'smtp_server': 'smtp.gmail.com',
        'smtp_port': 587,
        'description': 'Gmail'
    }
}
```

### Q4: å¦‚ä½•åœ¨å¾®ä¿¡ä¸Šæ¥æ”¶é‚®ä»¶é€šçŸ¥ï¼Ÿ

**A**: ä½¿ç”¨"QQé‚®ç®±æé†’"å°ç¨‹åºæˆ–å…¬ä¼—å·ï¼š
1. åœ¨å¾®ä¿¡ä¸­æœç´¢"QQé‚®ç®±æé†’"
2. ç»‘å®šä½ çš„QQé‚®ç®±è´¦å·
3. å³å¯åœ¨å¾®ä¿¡ä¸Šå®æ—¶æ¥æ”¶é‚®ä»¶é€šçŸ¥

### Q5: æµ‹è¯•æ¨¡å¼æœ‰ä»€ä¹ˆç”¨ï¼Ÿ

**A**: æµ‹è¯•æ¨¡å¼ç”¨äºï¼š
- æµ‹è¯•é…ç½®æ˜¯å¦æ­£ç¡®
- éªŒè¯é‚®ä»¶æ¨¡æ¿æ˜¯å¦æ­£å¸¸
- ä¸æ¶ˆè€—é‚®ä»¶é…é¢
- è°ƒè¯•å·¥ä½œæµç¨‹

è®¾ç½® `TEST_MODE=true` åï¼Œç³»ç»Ÿä¼šæ¨¡æ‹Ÿå‘é€ä½†ä¸çœŸæ­£å‘é€é‚®ä»¶ã€‚

### Q6: å¦‚ä½•å¤„ç†å¤šä¸ªæ”¶ä»¶äººï¼Ÿ

**A**: åœ¨ .env æ–‡ä»¶ä¸­ç”¨é€—å·åˆ†éš”ï¼š

```env
RECIPIENT_EMAILS=recipient1@qq.com,recipient2@163.com,recipient3@gmail.com
```

ç³»ç»Ÿä¼šè‡ªåŠ¨ä¸ºæ¯ä¸ªæ”¶ä»¶äººå‘é€é‚®ä»¶ã€‚

---

## æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: é‚®ä»¶è¿æ¥å¤±è´¥

**ç—‡çŠ¶**: `âœ— è¿æ¥å¤±è´¥: é‚®ç®±è®¤è¯å¤±è´¥`

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ `EMAIL_ADDRESS` æ˜¯å¦æ­£ç¡®
2. æ£€æŸ¥ `APP_PASSWORD` æ˜¯å¦æ­£ç¡®ï¼ˆä¸æ˜¯é‚®ç®±å¯†ç ï¼‰
3. ç¡®ä¿æˆæƒç æœªè¿‡æœŸ
4. æ£€æŸ¥ç½‘ç»œè¿æ¥

### é—®é¢˜ 2: é‚®ä»¶å‘é€å¤±è´¥

**ç—‡çŠ¶**: `âœ— é‚®ä»¶å‘é€å¤±è´¥: SMTPé”™è¯¯`

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥æ”¶ä»¶äººé‚®ç®±åœ°å€æ˜¯å¦æ­£ç¡®
2. æ£€æŸ¥ SMTP æœåŠ¡å™¨æ˜¯å¦å¯è®¿é—®
3. æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯
4. å°è¯•åœ¨æµ‹è¯•æ¨¡å¼ä¸‹è¿è¡Œ

### é—®é¢˜ 3: é…ç½®æ–‡ä»¶æ‰¾ä¸åˆ°

**ç—‡çŠ¶**: `FileNotFoundError: .env æ–‡ä»¶ä¸å­˜åœ¨`

**è§£å†³æ–¹æ¡ˆ**:
1. ç¡®ä¿ `.env` æ–‡ä»¶å­˜åœ¨
2. æ£€æŸ¥æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®
3. ä½¿ç”¨ç»å¯¹è·¯å¾„æŒ‡å®š .env æ–‡ä»¶ä½ç½®

### é—®é¢˜ 4: æ—¥å¿—æ–‡ä»¶æ— æ³•å†™å…¥

**ç—‡çŠ¶**: `PermissionError: æ— æ³•å†™å…¥æ—¥å¿—æ–‡ä»¶`

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ `logs/` ç›®å½•æ˜¯å¦å­˜åœ¨
2. æ£€æŸ¥ç›®å½•æƒé™
3. ç¡®ä¿æœ‰å†™å…¥æƒé™

### é—®é¢˜ 5: é‚®ä»¶æ¨¡æ¿æ˜¾ç¤ºä¸æ­£å¸¸

**ç—‡çŠ¶**: é‚®ä»¶ä¸­ HTML æ ¼å¼æ··ä¹±

**è§£å†³æ–¹æ¡ˆ**:
1. ä½¿ç”¨æ”¯æŒ HTML çš„é‚®ä»¶å®¢æˆ·ç«¯
2. æ£€æŸ¥é‚®ä»¶ç¼–ç æ˜¯å¦ä¸º UTF-8
3. å°è¯•åœ¨ä¸åŒé‚®ä»¶å®¢æˆ·ç«¯ä¸­æŸ¥çœ‹

---

## æ–‡ä»¶æ¸…å•

```
notifications/
â”œâ”€â”€ __init__.py
â””â”€â”€ email_notifier.py          # é‚®ä»¶é€šçŸ¥å™¨æ ¸å¿ƒæ¨¡å—

config/
â”œâ”€â”€ __init__.py
â””â”€â”€ config_loader.py           # é…ç½®åŠ è½½å™¨

email_alert_integration.py      # é‚®ä»¶æé†’é›†æˆè„šæœ¬
test_email_notification.py      # æµ‹è¯•è„šæœ¬
.env.example                    # é…ç½®æ¨¡æ¿
.env                           # é…ç½®æ–‡ä»¶ï¼ˆéœ€è¦è‡ªå·±åˆ›å»ºï¼‰
```

---

## ä¸‹ä¸€æ­¥

1. âœ… é…ç½® .env æ–‡ä»¶
2. âœ… è¿è¡Œæµ‹è¯•è„šæœ¬éªŒè¯é…ç½®
3. âœ… å‘é€æµ‹è¯•é‚®ä»¶
4. âœ… ä¸æå€¼æé†’ç³»ç»Ÿé›†æˆ
5. âœ… éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

---

**é‚®ä»¶é€šçŸ¥ç³»ç»Ÿå·²å‡†å¤‡å°±ç»ªï¼** ğŸ“§
"""
